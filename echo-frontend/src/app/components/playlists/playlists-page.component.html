<div class="playlists-page">
  <button class="create-btn" (click)="openCreateForm()">+ Nueva Playlist</button>

  <!-- Formulario crear playlist -->
  <div *ngIf="showCreateForm" class="modal">
    <h3>Nueva Playlist</h3>
    <input [(ngModel)]="newPlaylistName" placeholder="Nombre de la playlist" />
    <button (click)="createPlaylist()">Crear</button>
    <button (click)="cancelForms()">Cancelar</button>
  </div>

  <!-- Formulario editar playlist -->
  <div *ngIf="showEditForm" class="modal">
    <h3>Editar Playlist</h3>
    <input [(ngModel)]="editPlaylistName" placeholder="Nuevo nombre" />
    <button (click)="editPlaylist()">Guardar</button>
    <button (click)="cancelForms()">Cancelar</button>
  </div>

  <div *ngIf="loading">Cargando playlists...</div>
  <div *ngIf="error">{{ error }}</div>

  <!-- Lista de playlists -->
  <div *ngIf="!loading && playlists.length" class="playlist-grid">
    <div *ngFor="let playlist of playlists" class="playlist-card">
      <!-- AquÃ­ va el contenido de la tarjeta de playlist -->
      <div class="playlist-thumbnail">
        <!-- Puedes poner una miniatura aquÃ­ si hay alguna disponible, por ahora un placeholder -->
        <img src="assets/images/placeholder-playlist.png" alt="Miniatura de playlist">
      </div>
      <div class="playlist-info">
        <h3 class="playlist-name">{{ playlist.name }}</h3>
        <!-- Puedes aÃ±adir mÃ¡s info aquÃ­ si quieres -->
        <p class="playlist-stats">{{ playlist.songs?.length || 0 }} canciones</p>
      </div>
      <div class="playlist-actions">
        <button (click)="viewDetail(playlist)">Ver</button>
        <button (click)="openEditForm(playlist)">Editar</button>
        <button (click)="deletePlaylist(playlist)">Eliminar</button>
      </div>
      <!-- Indicador pÃºblica/privada -->
      <span *ngIf="playlist.isPublic" title="PÃºblica" class="playlist-status public">ğŸŒ PÃºblica</span>
      <span *ngIf="!playlist.isPublic" title="Privada" class="playlist-status private">ğŸ”’ Privada</span>
      <button *ngIf="playlist.isPublic" (click)="sharePlaylist(playlist)" class="share-btn">Compartir</button>
      <span *ngIf="playlist.publicUrl" class="public-url">
        Enlace: <a [href]="playlist.publicUrl" target="_blank">{{ playlist.publicUrl }}</a>
      </span>
    </div>
  </div>
  <div *ngIf="!loading && !playlists.length" class="no-playlists-message">No tienes playlists aÃºn.</div>

  <!-- Vista detalle playlist como modal -->
  <div *ngIf="showDetail && selectedPlaylist" class="modal">
    <div class="window-titlebar">
      <h3>{{ selectedPlaylist.name }}</h3>
       <button (click)="closeDetail()" class="close-btn">âœ•</button>
    </div>
     <div class="modal-content-area">
      <div *ngIf="selectedPlaylist.isPublic" style="color: green;">ğŸŒ Playlist pÃºblica</div>
      <div *ngIf="!selectedPlaylist.isPublic" style="color: gray;">ğŸ”’ Playlist privada</div>
      <button (click)="togglePublic(selectedPlaylist)">
        {{ selectedPlaylist.isPublic ? 'Hacer privada' : 'Hacer pÃºblica' }}
      </button>
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
      <p>ID: {{ selectedPlaylist.id }}</p>
      <button *ngIf="selectedPlaylist.isPublic" (click)="sharePlaylist(selectedPlaylist)">Compartir</button>
      <span *ngIf="selectedPlaylist.publicUrl">
        <br>Enlace pÃºblico: <a [href]="selectedPlaylist.publicUrl" target="_blank">{{ selectedPlaylist.publicUrl }}</a>
      </span>

      <h4>Canciones en esta playlist</h4>
      <ul *ngIf="selectedPlaylist.songs && selectedPlaylist.songs.length; else noSongs">
        <li *ngFor="let song of playlistSongsWithId">
          {{ song.title }}
          <button (click)="removeSongFromPlaylist(song)">Quitar</button>
        </li>
      </ul>
      <ng-template #noSongs>
        <div>No hay canciones en esta playlist.</div>
      </ng-template>

      <button (click)="playPlaylist()">Reproducir Playlist</button>
    </div>
  </div>
</div>
