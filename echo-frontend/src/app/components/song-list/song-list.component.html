@if (loading) {
  <div>Cargando canciones...</div>
} @else {
  @if (error) {
    <div>{{ error }}</div>
  } @else {
    @if (songs.length > 0) {
      <h2>Lista de canciones</h2>
      <ul>
        @for (song of songs; track song.id) {
          <li class="song-item" (contextmenu)="onSongContextMenu($event, song.id); $event.preventDefault()">
            <span (click)="playSong(song)" style="cursor:pointer;">
              @if (song.thumbnailFilename) {
                <img [src]="environment.apiUrl + '/audio/' + song.thumbnailFilename" alt="Portada de {{song.title}}" class="song-thumbnail-small">
              } @else {
                <img src="assets/images/placeholder-thumbnail.png" alt="Sin portada" class="song-thumbnail-small">
              }
              <strong>{{ song.title }}</strong> - {{ song.user.username }} ({{ song.genre.name }})
            </span>
            <!-- Acciones de la canción eliminadas -->
          </li>
        }
      </ul>
    } @else {
      <div>No hay canciones disponibles.</div>
    }
  }
}

<!-- Menú contextual para añadir a playlist -->
<app-context-menu
  #contextMenu
  *ngIf="showContextMenu && selectedSongId !== null"
  [show]="showContextMenu"
  [position]="contextMenuPosition"
  [playlists]="userPlaylists"
  [songId]="selectedSongId"
  (addToPlaylist)="onAddToPlaylistHandler($event)"
  (addToQueue)="onAddToQueueFromContextMenu($event)"
  (closeMenu)="showContextMenu = false">
</app-context-menu>

<!-- Mensaje de error del menú contextual -->
@if (contextMenuError) {
  <div class="context-menu-error">
    {{ contextMenuError }}
    <button (click)="contextMenuError = null">×</button>
  </div>
}
