<div class="vaporwave-effect">
  <header>
    <h1><a routerLink="/" class="window">Echo 🎵</a></h1>
    
    <nav>
      @if (isAdmin$ | async) {
        <a routerLink="/songs" routerLinkActive="active">🎵 Canciones</a>
      }
      @if (isAdmin$ | async) {
        <a routerLink="/public-playlists" routerLinkActive="active">📋 Explorar Playlists</a>
      }
      
      @if (isLoggedIn$ | async; as loggedIn) {
        <a routerLink="/upload-song" routerLinkActive="active">⬆️ Subir Canción</a>
        <a routerLink="/playback-history" routerLinkActive="active">⏱️ Historial</a>
        <a routerLink="/profile" routerLinkActive="active">👤 Mi Perfil</a>
        <div>
          <span>👋 Hola, {{ username$ | async }}</span>
          <button (click)="logout()" class="logout-btn">🚪 Cerrar Sesión</button>
        </div>
      } @else {
        <div>
          <a routerLink="/login" routerLinkActive="active">🔑 Iniciar Sesión</a>
          <a routerLink="/register" routerLinkActive="active">📝 Registrarse</a>
        </div>
      }
    </nav>
  </header>

  <main class="window" style="margin: 20px auto; min-height: 60vh;">
    <div class="window-content">
      <router-outlet></router-outlet>
    </div>
  </main>


  <!-- Reproductor de música flotante -->
  <div class="floating-player" *ngIf="(isLoggedIn$ | async) && isPlayerVisible">
    @if (currentSongForPlayer$ | async; as currentSong) {
      <app-song-player [song]="currentSong"></app-song-player>
    } @else {
      <app-song-player></app-song-player>
    }

    <!-- Botón para ocultar/mostrar el reproductor -->
    <button class="toggle-player-button" (click)="togglePlayerVisibility()">
      Ocultar Reproductor
    </button>
  </div>

  <!-- Botón para mostrar el reproductor cuando está oculto -->
  <button *ngIf="(isLoggedIn$ | async) && !isPlayerVisible" class="toggle-player-button show" (click)="togglePlayerVisibility()">
    Mostrar Reproductor
  </button>

  <footer>
    <div class="window" style="margin: 0; border-radius: 0;">
      <div class="window-content" style="text-align: center; padding: 8px;">
        <p style="margin: 0;">
          <span style="font-weight: bold;">Echo Player v1.0</span> | 
          &copy; {{ getYear() }} Echo App. 
          <span style="color: #ff00ff;">Windows 95 Vaporwave Edition</span>
        </p>
      </div>
    </div>
  </footer>
</div>
